{% extends "base.html.j2" %}

{% block styles %}
    {{ super() }}
    <link rel="stylesheet" href="{{ request.url_for('static', path='css/period_selector.css') }}">
    <link rel="stylesheet" href="{{ request.url_for('static', path='css/analysis.css') }}">
{% endblock %}

{% block scripts %}
    {{ super() }}
    <!-- Store period parameters for JavaScript to use -->
    <script>
    window.analysisConfig = {
        period: "{{ period }}",
        comparisonPeriod: "{{ comparison_period or 'none' }}"
    };
    </script>
    <!-- Period selector and analysis JavaScript -->
    <script src="{{ request.url_for('static', path='js/period_selector.js') }}"></script>
    <script src="{{ request.url_for('static', path='js/analysis.js') }}"></script>
{% endblock %}

{% block content %}
<!-- Period Selection Controls -->
<div class="analysis-controls">
    {% set id = 'primary-period' %}
    {% set label = _('Analysis period:') %}
    {% set initial_period = period|default('month') %}
    {% set onchange_callback = 'onPrimaryPeriodChange' %}
    {% set show_historical = true %}
    {% include 'components/period_selector.html.j2' %}

    <div class="comparison-controls" style="margin-top: 1rem;">
        <label style="font-size: 0.85rem; color: var(--color-text-secondary); margin-right: 0.5rem;">
            <input type="checkbox" id="enable-comparison" onchange="toggleComparison()" {% if comparison_period and comparison_period != 'none' %}checked{% endif %}>
            {{ _('Compare with previous period') }}
        </label>
    </div>
</div>

<!-- Analysis content container -->
<div id="analysis-loading" class="loading-indicator" style="display: none;">
    {{ _('Loading analysis data...') }}
</div>
<div id="analysis-content">
    <!-- Content loaded by JavaScript -->
</div>

<!-- Footer annotation -->
<p class="annotation mt-2 pt-1 border-top" id="analysis-footer">
    {{ _('Confidence threshold: â‰¥%(threshold)s', threshold=config.species_confidence_threshold) }}
</p>

{% endblock %}
