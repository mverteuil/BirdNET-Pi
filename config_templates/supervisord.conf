[supervisord]
nodaemon=true

[unix_http_server]
file=/dev/shm/supervisor.sock   ; path to your socket file

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///dev/shm/supervisor.sock ; use a unix:// URL  for a unix socket

[program:caddy]
command=/usr/bin/caddy run --config /etc/caddy/Caddyfile
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:fastapi]
command=/opt/birdnetpi/.venv/bin/uvicorn birdnetpi.web.main:app --host 0.0.0.0 --port 8888
autostart=true
autorestart=true
stdout_logfile=/var/log/birdnetpi/fastapi.log
stdout_logfile_maxbytes=1MB
stdout_logfile_backups=10
stderr_logfile=/var/log/birdnetpi/fastapi_err.log
stderr_logfile_maxbytes=1MB
stderr_logfile_backups=10
environment=PYTHONPATH=/opt/birdnetpi/src
directory=/opt/birdnetpi

[program:pulseaudio]
command=pulseaudio --daemonize=no --exit-idle-time=-1
autostart=true
autorestart=true
stdout_logfile=/var/log/birdnetpi/pulseaudio.log
stdout_logfile_maxbytes=1MB
stdout_logfile_backups=10
stderr_logfile=/var/log/birdnetpi/pulseaudio_err.log
stderr_logfile_maxbytes=1MB
stderr_logfile_backups=10
priority=100

[program:audio_capture]
command=/opt/birdnetpi/.venv/bin/audio-capture-daemon
autostart=true
autorestart=true
stdout_logfile=/var/log/birdnetpi/audio_capture.log
stdout_logfile_maxbytes=1MB
stdout_logfile_backups=10
stderr_logfile=/var/log/birdnetpi/audio_capture_err.log
stderr_logfile_maxbytes=1MB
stderr_logfile_backups=10
environment=PYTHONPATH=/opt/birdnetpi/src
directory=/opt/birdnetpi
priority=200

[program:audio_analysis]
command=/opt/birdnetpi/.venv/bin/audio-analysis-daemon
autostart=true
autorestart=true
stdout_logfile=/var/log/birdnetpi/audio_analysis.log
stdout_logfile_maxbytes=1MB
stdout_logfile_backups=10
stderr_logfile=/var/log/birdnetpi/audio_analysis_err.log
stderr_logfile_maxbytes=1MB
stderr_logfile_backups=10
environment=PYTHONPATH=/opt/birdnetpi/src
directory=/opt/birdnetpi
priority=300

[program:audio_websocket]
command=/opt/birdnetpi/.venv/bin/audio-websocket-daemon
autostart=true
autorestart=true
stdout_logfile=/var/log/birdnetpi/audio_websocket.log
stdout_logfile_maxbytes=1MB
stdout_logfile_backups=10
stderr_logfile=/var/log/birdnetpi/audio_websocket_err.log
stderr_logfile_maxbytes=1MB
stderr_logfile_backups=10
environment=PYTHONPATH=/opt/birdnetpi/src
directory=/opt/birdnetpi
priority=300

[program:spectrogram_websocket]
command=/opt/birdnetpi/.venv/bin/python -m birdnetpi.wrappers.spectrogram_websocket_daemon
autostart=true
autorestart=true
stdout_logfile=/var/log/birdnetpi/spectrogram_websocket.log
stdout_logfile_maxbytes=1MB
stdout_logfile_backups=10
stderr_logfile=/var/log/birdnetpi/spectrogram_websocket_err.log
stderr_logfile_maxbytes=1MB
stderr_logfile_backups=10
environment=PYTHONPATH=/opt/birdnetpi/src
directory=/opt/birdnetpi
priority=300
